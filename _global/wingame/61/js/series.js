var page_submitted=false;var current_page='';var calculate_prize_images_timeout=false;window.addEvents({'domready':function(){current_page=$(document.body).get('id');switch(current_page){case'page_pregame':series_on_page_pregame();break;case'page_reg_full':series_on_page_reg_full();break;case'page_reg_half':series_on_page_reg_half();break;default:break;}},'load':function(){calculate_prize_images('load');},'resize':function(){if(calculate_prize_images_timeout==false){if($('prize_images').hasClass('animating')==false){calculate_prize_images_timeout=true;setTimeout(function(){calculate_prize_images('resize');calculate_prize_images_timeout=false;},100);}else{setTimeout(function(){window.fireEvent('resize');},37);}}
arrange_page(false);},'page_ready':function(){arrange_page(true);}});var series_on_page_pregame=function(){$('page_content').addClass('hidden');shortage.initialize(shortage_articles);color_picker();if($$('html')[0].hasClass('ie7')==false&&$$('html')[0].hasClass('ie8')==false&&$$('html')[0].hasClass('ie9')==false){animation_initialize();}};var series_on_page_reg_half=function(){click_on_status();bigger_checkbox();};var series_on_page_reg_full=function(){click_on_status();bigger_checkbox();};var arrange_page=function(first_load){if(current_page=='page_pregame'){choose_color.execute();}
if(first_load==true){show_color();$('page_content').removeClass('hidden');$$('footer')[0].removeClass('hidden');if(current_page=='page_pregame'){shortage.calculate_height();}}
position_footer();};var click_on_status=function(){$$('span.status').addEvents({'click':function(){var status=$(this);if(status.hasClass('mooli_error')==true){var fields=status.getParent('.formrow').getElements('.validate');if(fields.length>0){fields[0].focus();}}}});};var position_footer=function(){var header=$$('header')[0];var footer=$$('footer')[0];var viewport_height=window.getSize().y;var content_height=Math.ceil(header.getSize().y+ $('main').getSize().y+ footer.getSize().y);if(content_height<viewport_height){footer.addClass('fixed');}else{footer.removeClass('fixed');}};var calculate_prize_images=function(event_trigger){var image_height=0;if($$('#prize_images .active img').length>0){image_height=$$('#prize_images .active img')[0].getSize().y;}else{if($$('#prize_images .show').length==0&&$$('#prize_images .hide').length==0){var prize_style=$$('#prize_images img')[0].getProperty('style');$$('#prize_images img')[0].setStyles({width:'100%'});image_height=$$('#prize_images img')[0].getSize().y;$$('#prize_images img')[0].setProperty('style',prize_style);}}
if(image_height===0||$('prize_images').hasClass('animating')){if(event_trigger=='load'){setTimeout(function(){calculate_prize_images(event_trigger);},100);}}else{$('prize_images').setStyle('height',image_height);$$('#prize_images div').setStyle('height',image_height);window.fireEvent('page_ready');}};var color_picker=function(){$$('#prize_colors input[name=wingame_special_answer]').addEvents({'click':function(){$$('#prize_colors .color_wrapper.active').removeClass('active');$(this).getParent('.color_wrapper').addClass('active');animate_prizes($(this).get('id').replace(/^color_/gi,''));}});};var animation_initialize=function(){var prize_images=$$('#prize_images div img');prize_images.each(function(prize_image){prize_image.set('morph',{duration:400,unit:'%',link:'cancel'});if(prize_image.hasClass('prize_left')==true){if(prize_image.getParent('div').hasClass('active')==true){prize_image.setStyles({width:'100%',top:'0%',left:'0%'});}else{prize_image.setStyles({width:'0%',top:'50%',left:'40%'});}}else{if(prize_image.getParent('div').hasClass('active')==true){prize_image.setStyles({width:'100%',top:'0%',right:'0%'});}else{prize_image.setStyles({width:'0%',top:'50%',right:'40%'});}}});};var animate_prizes=function(color_id){animate_prizes.color_id=color_id;animate_prizes.show_prize=function(prize_image){prize_image.getParent('div').addClass('active');if(prize_image.hasClass('prize_left')==true){setTimeout(function(){prize_image.morph({width:100,top:0,left:0,onComplete:function(){setTimeout(function(){prize_image.getParent('div').removeClass('show');$('prize_images').removeClass('animating');},250);}});},250);}else{prize_image.morph({width:100,top:0,right:0});}};animate_prizes.show_prize_old_ie=function(prize_image){prize_image.getParent('div').addClass('active');prize_image.fade('show');if(prize_image.hasClass('prize_left')==true){setTimeout(function(){prize_image.getParent('div').removeClass('show');$('prize_images').removeClass('animating');},50);}};animate_prizes.show_prizes=function(prize_images){if(typeof(prize_images)==='undefined'){prize_images=$$('#prizes_'+ animate_prizes.color_id);}
prize_images.addClass('show');prize_images.getElements('img')[0].each(function(prize_image){if($$('html')[0].hasClass('ie7')==true||$$('html')[0].hasClass('ie8')==true||$$('html')[0].hasClass('ie9')==true){animate_prizes.show_prize_old_ie(prize_image);}else{animate_prizes.show_prize(prize_image);}});};animate_prizes.hide_prize=function(prize_image){$('prize_images').addClass('animating');if(prize_image.hasClass('prize_left')==true){setTimeout(function(){prize_image.morph({width:0,top:50,left:40,onComplete:function(){setTimeout(function(){prize_image.getParent('div').removeClass('hide');prize_image.getParent('div').removeClass('active');animate_prizes.show_prizes();},250);}});},250);}else{prize_image.morph({width:0,top:50,right:40});}};animate_prizes.hide_prize_old_ie=function(prize_image){$('prize_images').addClass('animating');prize_image.fade('hide');if(prize_image.hasClass('prize_left')==true){setTimeout(function(){prize_image.getParent('div').removeClass('hide');prize_image.getParent('div').removeClass('active');animate_prizes.show_prizes();},50);}};animate_prizes.hide_prizes=function(prize_images){if(typeof(prize_images)==='undefined'){prize_images=$$('#prize_images .active');}
if(prize_images.length>0){prize_images.addClass('hide');prize_images.getElements('img')[0].each(function(prize_image){if($$('html')[0].hasClass('ie7')==true||$$('html')[0].hasClass('ie8')==true||$$('html')[0].hasClass('ie9')==true){animate_prizes.hide_prize_old_ie(prize_image);}else{animate_prizes.hide_prize(prize_image);}});}else{animate_prizes.show_prizes();}};animate_prizes.control=function(){var prizes_show=$$('#prize_images .show');if(prizes_show.length>0){animate_prizes.hide_prizes(prizes_show);}else{animate_prizes.hide_prizes();}};animate_prizes.control();};var choose_color={color_id:1,execute:function(){var self=this;if(get_parameter('wingame_special_answer')!=''){var param_color=$$('#prize_colors input[value='+ get_parameter('wingame_special_answer')+']');if(param_color.length>0){self.color_id=param_color[0].get('id').replace(/^color_/gi,'');}}
$$('#prize_colors .color_'+ self.color_id).addClass('active');$$('#color_'+ self.color_id).set('checked',true);animate_prizes(self.color_id);},set_color:function(color_id){var self=this;if(color_id>=1&&color_id<=3){self.color_id=color_id;}}};var show_color=function(){if(current_page!='page_pregame'){var chosen_color=$$('input[name=wingame_special_answer]')[0].get('value');var prizes_id=prize_colors.indexOf(chosen_color)+ 1;if(prizes_id<1||prizes_id>3){prizes_id=1;}
$$('#prizes_'+ prizes_id).addClass('active');}};var shortage={current_article:-1,initialize:function(shortage_articles){var self=this;shortage_articles=JSON.decode(shortage_articles);if(typeof(shortage_articles)=='object'){shortage_articles=shortage_articles.pregame_content_rotating_text.split('\n');if(shortage_articles.length>0){if(shortage_articles!='Pregame rotating text'){self.insert_articles(shortage_articles);self.calculate_height();$('shortage').removeClass('hidden');setTimeout(function(){self.show_next_article();},500);}}}},insert_articles:function(shortage_articles){var self=this;shortage_articles.each(function(article,index){var article_element=new Element('article',{id:'article_'+ index,html:article});article_element.inject($('shortage'));});},show_next_article:function(){var self=this;if(self.current_article<$$('#shortage article').length- 1){if(self.current_article>-1){self.hide_article($('article_'+ self.current_article));}
self.current_article++;if(self.current_article<$$('#shortage article').length){self.show_article($('article_'+ self.current_article));var show_next_in=parseInt((Math.random()*3000)+ 2000);setTimeout(function(){self.show_next_article();},show_next_in);}}},hide_article:function(article){article.removeClass('active');},show_article:function(article){setTimeout(function(){article.addClass('active');},300);},calculate_height:function(){var self=this;var highest_article=0;$$('#shortage article').each(function(article){var article_height=article.getSize().y;if(article_height>highest_article){highest_article=article_height;}});$('shortage').setStyle('height',highest_article);}};var bigger_checkbox=function(){if($$('label.bigger_checkbox').length>0){var bigger_checkbox=$$('label.bigger_checkbox')[0];if(bigger_checkbox.get('checked')){bigger_checkbox.addClass('checked');}
bigger_checkbox.addEvent('click',function(){if(isIE('8')==true||isIE('7')==true){$(this.getProperty('for')).click();if($(this.getProperty('for')).checked==true||$(this.getProperty('for')).checked=='checked'){this.addClass('checked');}else{this.removeClass('checked');}}else{if($(this.getProperty('for')).checked==true||$(this.getProperty('for')).checked=='checked'){this.removeClass('checked');}else{this.addClass('checked');}}});}};var iframe_selector=new Class({Implements:Options,options:{target_window:'popped_iframe'},regex_pdf:/\.pdf$/,initialize:function(options){var _self=this;_self.setOptions(options);_self.check_selectors();},check_selectors:function(){var _self=this;Object.each(_self.options.selectors,function(value,key){for(var i=0;i<$$(key).length;i++){if($$(key)[i].get('tag')=='a'){if(value.regex&&typeof(value.regex)=='object'){if(_self.check_selector_regex($$(key)[i],value.regex)===true){_self.setup_selector($$(key)[i],value.type);}}else{_self.setup_selector($$(key)[i],value.type);}}else{i=$$(key).length+1;var links=$$(key+' a');for(var x=0;x<links.length;x++){if(value.regex&&typeof(value.regex)=='object'){if(_self.check_selector_regex(links[x],value.regex)===true){_self.setup_selector(links[x],value.type);}}else{_self.setup_selector(links[x],value.type);}}}}});},setup_selector:function(element,type){var _self=this;if(element.hasClass('advertiselink')===true||element.hasClass('ignore'))return;if(element.href){element.removeEvents();if(element.href.test(_self.regex_pdf)==false){if(type=='iframe'){element.target=_self.options.target_window;element.addEvent('click',function(){open_iframe();});}
if(type=='layer'){element.target=_self.options.target_window;clean_links(element);element.addEvent('click',function(){open_layer(element,element.href);});}}else{element.target=_self.options.target_window;element.addEvent('click',function(){open_iframe();});}}},check_selector_regex:function(element,regex_obj){var _self=this;var clear=false;if(regex_obj[0]!==undefined){Object.each(regex_obj,function(value,key){if(element.href&&element.href.test(value)){clear=true;}});}else{if(element.href&&element.href.test(regex_obj)){clear=true;}}
return clear;}});var open_iframe=function(){scroll_position_x=window.getScroll().y;$('pop_iframe').setStyle('display','block');$('content_wrapper').setStyle('display','none');var height;if(window.innerHeight){height=window.innerHeight;}else if(document.body){height=document.body.clientHeight;}else{height=$(document.body).getStyle('height');}
$('popped_iframe').setStyle('height',(document.documentElement.clientHeight||window.innerHeight)- 4);window.scroll(0,0);};var open_layer=function(element,href){scroll_position_x=window.getScroll().y;if(href){var link=href;}else{var link=element.href;}
new Request({url:link,method:'GET',onSuccess:function(response){$('pop_iframe').setStyle('display','block');$$('#pop_iframe iframe')[0].setStyle('height',0);$$('#pop_iframe iframe')[0].setStyle('display','none');if($('content_wrapper')){$('content_wrapper').setStyle('display','none');}
if(!$('popped_layer')){var popped_layer=new Element('div',{id:'popped_layer'});popped_layer.inject($('pop_iframe_closer'),'before');}
$('popped_layer').set('html',response);$$('#popped_layer link').dispose();$$('#popped_layer meta').dispose();$$('#popped_layer style').dispose();$$('#popped_layer title').dispose();$$('#popped_layer a').each(function(element){if(element.href.test(/self.close()/)==true||element.href.test(/window.close()/)==true){element.dispose();}});$('pop_iframe_closer').addClass('popped_layer');$('pop_iframe').setStyle('background-color',$('popped_layer').getStyle('background-color'));$$('#popped_layer .poplink, #popped_layer .sponsoren_iframe').each(function(element,index){if(element.href.test(/sponsor.htm|cgi-bin|_sponsoren/)===true){if(element.hasClass('ignore')===false){element.removeAttribute('target');clean_links(element);var href=element.href;element.href='javascript://';element.removeClass('poplink');element.addEvent('click',function(){$('pop_iframe_closer').fireEvent('click');open_layer(element,href);});}}});}}).send();window.scroll(0,0);};var clean_links=function(link){var link_href=link.href;if(link_href.test('www.planet49.'+ context+'')===true||link_href.test(context+'.web.planet49.com')===true){link_href=link_href.replace('http://www./','');link_href=link_href.replace('https://www./','');link_href=link_href.replace('http://','');link_href=link_href.replace('https:///','');link_href=link_href.replace('planet49.'+ context+'.com','');link_href=link_href.replace('planet49.'+ context+'','');link_href=link_href.replace(context+'.web.planet49.com','');}
link.href=link_href;};var add_pop_iframe_closer_events=function(){$('pop_iframe_closer').addEvent('click',function(){if($('content_wrapper')){$('content_wrapper').setStyle('display','block');}
$('pop_iframe').setStyle('display','none');$('pop_iframe').setStyle('height','0px');$('popped_iframe').set('src','about:blank');if($('popped_layer')){$('popped_layer').empty();$('popped_layer').destroy();$$('#pop_iframe iframe')[0].removeProperty('style');$('pop_iframe_closer').removeClass('popped_layer');}
window.scroll(0,scroll_position_x);});};